<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lukas Linauer</title>
    <meta name="description" content="Personal website of Lukas Linauer" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg-glow bg-glow-a" aria-hidden="true"></div>
    <div class="bg-glow bg-glow-b" aria-hidden="true"></div>

    <main class="container">
      <section class="panel about">
        <p class="eyebrow">ABOUT ME</p>
        <h1>Hi, I’m Lukas Linauer</h1>
        <p>
          I like building practical software, experimenting with AI, and shipping small ideas quickly.
          This page pulls my repositories directly from GitHub.
        </p>
      </section>

      <section class="panel repos">
        <div class="repos-head">
          <p class="eyebrow">PROJECTS</p>
          <h2>My Repositories</h2>
        </div>

        <div id="repo-grid" class="repo-grid" aria-live="polite"></div>
        <p id="status" class="status">Loading repositories…</p>
      </section>
    </main>

    <script>
      const USERNAME = 'llinauer';

      async function loadRepos() {
        const grid = document.getElementById('repo-grid');
        const status = document.getElementById('status');

        try {
          const res = await fetch(`https://api.github.com/users/${USERNAME}/repos?per_page=100&sort=updated`);
          if (!res.ok) throw new Error('Failed to fetch repositories');

          /** @type {Array<{name:string,html_url:string,description:string,stargazers_count:number,fork:boolean,owner:{login:string}}>} */
          const repos = await res.json();

          const filtered = repos
            .filter((r) => !r.fork)
            .sort((a, b) => b.stargazers_count - a.stargazers_count || a.name.localeCompare(b.name));

          if (!filtered.length) {
            status.textContent = 'No repositories found.';
            return;
          }

          grid.innerHTML = filtered
            .map((repo) => {
              const thumb = `https://opengraph.githubassets.com/1/${repo.owner.login}/${repo.name}`;
              const desc = repo.description ? repo.description.replace(/</g, '&lt;').replace(/>/g, '&gt;') : 'No description yet.';
              return `
                <article class="repo-card">
                  <a href="${repo.html_url}" target="_blank" rel="noreferrer" aria-label="Open ${repo.name} on GitHub">
                    <img class="thumb" src="${thumb}" alt="${repo.name} repository preview" loading="lazy" />
                    <div class="repo-meta">
                      <h3>${repo.name}</h3>
                      <p>${desc}</p>
                    </div>
                  </a>
                </article>
              `;
            })
            .join('');

          status.textContent = `${filtered.length} repositories shown.`;
        } catch (err) {
          status.textContent = 'Could not load repositories right now. Please refresh later.';
        }
      }

      loadRepos();
    </script>
  </body>
</html>
